var Kt=Object.defineProperty;var Jt=(t,e,r)=>e in t?Kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var se=(t,e,r)=>Jt(t,typeof e!="symbol"?e+"":e,r);import{r as s,j as o,N as Qt,c as B,b as z,d as yt,a as E,e as q,R as b,f as je,g as oe,h as Ye,k as Ue,B as Be,l as jt,m as ze,n as kt,L as Xt,S as _e,o as en,p as tn,q as nn,s as Ct,t as Ft,v as $,w as rn,i as D,x as an,y as sn,z as on,A as Oe,C as ln,D as cn,F as lt,G as un,H as it,O as dn}from"./index-DH1v9iOD.js";import{R as mn}from"./ReportErrors-CaaGo6UD.js";import{u as j,M as fn,a as Ve,E as ie}from"./plan-BC79Qq7e.js";import{E as Z,P as ct,S as pn}from"./SelectEnvironment-GfN4mjDu.js";import{o as ee,i as qe,f as vn,I as Ge,E as Nt,a as hn,n as At,K as ce,y as Fe,l as Rt,b as Pt,u as gn,c as ke,d as We,e as Ee,g as ve,T as Q,p as xn,L as he,h as ut,s as dt,j as wn,k as Y,m as Tt,t as bn,q as Mt,r as mt,v as $t,P as ft,z as Ce,F as Dt,w as ye,x as En,A as yn,H as jn,B as kn,S as Cn,C as Fn,D as Nn,G as An,J as Rn,M as pt,N as Pn,O as Tn,Q as Mn,R as vt,U as ht}from"./popover-BS2D7N_A.js";import{F as $n}from"./ChevronRightIcon-UI3RytmK.js";import{u as J,M as Ze}from"./project-YuVl6ae5.js";import{H as Dn,y as Ln,w as Sn}from"./ListboxShow-BRUdoaSL.js";import{M as gt}from"./file-gUDWL5Z6.js";import{u as ne,c as On}from"./editor-DQqZC36D.js";import{EnumFileExplorerChange as He}from"./context-DUS5wzfN.js";import"./PlusCircleIcon-M3NGeHST.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./SplitPane-CqYEXonR.js";import"./context-C6O7H5eL.js";import"./floating-ui.react-dom-9Mo3XjFw.js";import"./help-6Q7f7fjd.js";import"./SourceList-BioJ2XB9.js";import"./Input-BGdTmRPV.js";import"./index-Ditw2lX8.js";import"./ModelLineage-BVQJptIB.js";import"./SearchList-vj2s_Pnb.js";import"./ChevronDownIcon-DtTgO9XQ.js";function Zn({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z",clipRule:"evenodd"}))}const Hn=s.forwardRef(Zn);function In({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const Bn=s.forwardRef(In);function zn({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M3 3.5A1.5 1.5 0 0 1 4.5 2h6.879a1.5 1.5 0 0 1 1.06.44l4.122 4.12A1.5 1.5 0 0 1 17 7.622V16.5a1.5 1.5 0 0 1-1.5 1.5h-11A1.5 1.5 0 0 1 3 16.5v-13Zm10.857 5.691a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 0 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z",clipRule:"evenodd"}))}const _n=s.forwardRef(zn);function Vn({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M4.5 2A1.5 1.5 0 0 0 3 3.5v13A1.5 1.5 0 0 0 4.5 18h11a1.5 1.5 0 0 0 1.5-1.5V7.621a1.5 1.5 0 0 0-.44-1.06l-4.12-4.122A1.5 1.5 0 0 0 11.378 2H4.5Zm2.25 8.5a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Zm0 3a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z",clipRule:"evenodd"}))}const qn=s.forwardRef(Vn);function Wn({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495ZM10 5a.75.75 0 0 1 .75.75v3.5a.75.75 0 0 1-1.5 0v-3.5A.75.75 0 0 1 10 5Zm0 9a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",clipRule:"evenodd"}))}const Yn=s.forwardRef(Wn);function Un({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{d:"M3.75 3A1.75 1.75 0 0 0 2 4.75v3.26a3.235 3.235 0 0 1 1.75-.51h12.5c.644 0 1.245.188 1.75.51V6.75A1.75 1.75 0 0 0 16.25 5h-4.836a.25.25 0 0 1-.177-.073L9.823 3.513A1.75 1.75 0 0 0 8.586 3H3.75ZM3.75 9A1.75 1.75 0 0 0 2 10.75v4.5c0 .966.784 1.75 1.75 1.75h12.5A1.75 1.75 0 0 0 18 15.25v-4.5A1.75 1.75 0 0 0 16.25 9H3.75Z"}))}const Gn=s.forwardRef(Un);function Kn({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm6.39-2.908a.75.75 0 0 1 .766.027l3.5 2.25a.75.75 0 0 1 0 1.262l-3.5 2.25A.75.75 0 0 1 8 12.25v-4.5a.75.75 0 0 1 .39-.658Z",clipRule:"evenodd"}))}const Lt=s.forwardRef(Kn);function Jn({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M9.661 2.237a.531.531 0 0 1 .678 0 11.947 11.947 0 0 0 7.078 2.749.5.5 0 0 1 .479.425c.069.52.104 1.05.104 1.59 0 5.162-3.26 9.563-7.834 11.256a.48.48 0 0 1-.332 0C5.26 16.564 2 12.163 2 7c0-.538.035-1.069.104-1.589a.5.5 0 0 1 .48-.425 11.947 11.947 0 0 0 7.077-2.75Zm4.196 5.954a.75.75 0 0 0-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 1 0-1.06 1.061l2.5 2.5a.75.75 0 0 0 1.137-.089l4-5.5Z",clipRule:"evenodd"}))}const Qn=s.forwardRef(Jn);function Xn({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{d:"M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785l-.238-1.192ZM6.949 5.684a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633L6.95 5.684ZM13.949 13.684a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632l-.183-.551Z"}))}const xt=s.forwardRef(Xn);function er({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{fillRule:"evenodd",d:"M.99 5.24A2.25 2.25 0 0 1 3.25 3h13.5A2.25 2.25 0 0 1 19 5.25l.01 9.5A2.25 2.25 0 0 1 16.76 17H3.26A2.267 2.267 0 0 1 1 14.74l-.01-9.5Zm8.26 9.52v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75v.615c0 .414.336.75.75.75h5.373a.75.75 0 0 0 .627-.74Zm1.5 0a.75.75 0 0 0 .627.74h5.373a.75.75 0 0 0 .75-.75v-.615a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75v.625Zm6.75-3.63v-.625a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75v.625c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75Zm-8.25 0v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75v.625c0 .414.336.75.75.75H8.5a.75.75 0 0 0 .75-.75ZM17.5 7.5v-.625a.75.75 0 0 0-.75-.75H11.5a.75.75 0 0 0-.75.75V7.5c0 .414.336.75.75.75h5.25a.75.75 0 0 0 .75-.75Zm-8.25 0v-.625a.75.75 0 0 0-.75-.75H3.25a.75.75 0 0 0-.75.75V7.5c0 .414.336.75.75.75H8.5a.75.75 0 0 0 .75-.75Z",clipRule:"evenodd"}))}const wt=s.forwardRef(er);function tr({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25h.375a9 9 0 0 1 9 9v.375M10.125 2.25A3.375 3.375 0 0 1 13.5 5.625v1.5c0 .621.504 1.125 1.125 1.125h1.5a3.375 3.375 0 0 1 3.375 3.375M9 15l2.25 2.25L15 12"}))}const nr=s.forwardRef(tr);function rr({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const ar=s.forwardRef(rr);function sr({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const or=s.forwardRef(sr);function lr({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"}))}const ir=s.forwardRef(lr);function cr({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"}))}const St=s.forwardRef(cr);function ur({title:t,titleId:e,...r},a){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":e},r),t?s.createElement("title",{id:e},t):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const dr=s.forwardRef(ur);function W({title:t,to:e,icon:r,iconActive:a,classActive:i="px-2 bg-neutral-10",disabled:l=!1,children:m,before:p,className:h}){return o.jsx(Qt,{title:t,to:e,className:({isActive:f})=>B("flex items-center",l&&"opacity-50 cursor-not-allowed",f&&z(l)&&i,h),style:({isActive:f})=>f||l?{pointerEvents:"none"}:{},children:({isActive:f})=>o.jsxs("span",{className:B("flex items-center",f?"font-bold":"font-normal"),children:[p,f?a:r,m]})})}function mr({className:t}){const{errors:e}=yt(),r=E(l=>l.models),a=E(l=>l.modules),i=Array.from(new Set(r.values())).length;return o.jsxs("div",{className:t,children:[a.hasEditor&&o.jsx(W,{title:"File Explorer",to:q.Editor,className:"px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-primary-500 rounded-xl my-1",classActive:"bg-primary-10 text-primary-500",icon:o.jsx(ir,{className:"min-w-6 w-6"}),iconActive:o.jsx(Gn,{className:"min-w-6 w-6"})}),a.hasDataCatalog&&o.jsx(W,{title:"Data Catalog",to:q.DataCatalog,icon:o.jsx(ar,{className:"min-w-6 w-6"}),iconActive:o.jsx(qn,{className:"min-w-6 w-6"}),className:"relative rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-600 dark:text-neutral-300",children:o.jsx("span",{className:"min-w-[1rem] px-1 h-4 py-0.5 text-center text-[9px] absolute bottom-0 right-0 font-black rounded-full bg-primary-500 text-primary-100",children:i})}),a.hasErrors&&o.jsx(W,{title:"Errors",to:q.Errors,className:B("relative px-2 py-1 rounded-xl my-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10",e.size>0?"text-danger-500":"text-neutral-600"),classActive:"px-2 bg-danger-10 text-danger-500",icon:o.jsx(or,{className:"w-6"}),iconActive:o.jsx(Yn,{className:"w-6"}),disabled:e.size===0,children:e.size>0&&o.jsx("span",{className:"min-w-[1rem] px-1 h-4 py-0.5 text-center text-[9px] absolute bottom-0 right-0 font-black rounded-full bg-danger-500 text-danger-100",children:e.size})}),a.hasPlans&&o.jsx(W,{title:"Plan",to:q.Plan,className:"px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-success-500 rounded-xl my-1",classActive:"bg-success-10 text-success-500",icon:o.jsx(St,{className:"w-6"}),iconActive:o.jsx(Lt,{className:"w-6"})}),a.hasTests&&o.jsx(W,{title:"Tests",to:q.Tests,icon:o.jsx(nr,{className:"w-6"}),iconActive:o.jsx(_n,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10"}),a.hasAudits&&o.jsx(W,{title:"Audits",to:q.Audits,icon:o.jsx(dr,{className:"w-6"}),iconActive:o.jsx(Qn,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10"}),a.hasData&&o.jsx(W,{title:"Data",to:q.Data,icon:o.jsx(wt,{className:"w-6"}),iconActive:o.jsx(wt,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-500 dark:text-neutral-300"}),a.hasLineage&&o.jsx(W,{title:"Lineage",to:q.Lineage,icon:o.jsx(xt,{className:"w-6"}),iconActive:o.jsx(xt,{className:"w-6"}),className:"rounded-xl my-1 px-2 py-1 h-10 hover:bg-neutral-5 dark:hover:bg-neutral-10 text-neutral-500 dark:text-neutral-300"})]})}function Ke(t,e){let r=s.useRef([]),a=ee(t);s.useEffect(()=>{let i=[...r.current];for(let[l,m]of e.entries())if(r.current[l]!==m){let p=a(e,i);return r.current=e,p}},[a,...e])}function fr(t){function e(){document.readyState!=="loading"&&(t(),document.removeEventListener("DOMContentLoaded",e))}typeof window<"u"&&typeof document<"u"&&(document.addEventListener("DOMContentLoaded",e),e())}let X=[];fr(()=>{function t(e){if(!qe(e.target)||e.target===document.body||X[0]===e.target)return;let r=e.target;r=r.closest(vn),X.unshift(r??e.target),X=X.filter(a=>a!=null&&a.isConnected),X.splice(10)}window.addEventListener("click",t,{capture:!0}),window.addEventListener("mousedown",t,{capture:!0}),window.addEventListener("focus",t,{capture:!0}),document.body.addEventListener("click",t,{capture:!0}),document.body.addEventListener("mousedown",t,{capture:!0}),document.body.addEventListener("focus",t,{capture:!0})});function pr(t,e=typeof document<"u"?document.defaultView:null,r){let a=Ge(t,"escape");Nt(e,"keydown",i=>{a&&(i.defaultPrevented||i.key===hn.Escape&&r(i))})}function vr(){var t;let[e]=s.useState(()=>typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia("(pointer: coarse)"):null),[r,a]=s.useState((t=e==null?void 0:e.matches)!=null?t:!1);return At(()=>{if(!e)return;function i(l){a(l.matches)}return e.addEventListener("change",i),()=>e.removeEventListener("change",i)},[e]),r}function Ot(t){if(!t)return new Set;if(typeof t=="function")return new Set(t());let e=new Set;for(let r of t.current)bn(r.current)&&e.add(r.current);return e}let hr="div";var re=(t=>(t[t.None=0]="None",t[t.InitialFocus=1]="InitialFocus",t[t.TabLock=2]="TabLock",t[t.FocusLock=4]="FocusLock",t[t.RestoreFocus=8]="RestoreFocus",t[t.AutoFocus=16]="AutoFocus",t))(re||{});function gr(t,e){let r=s.useRef(null),a=Fe(r,e),{initialFocus:i,initialFocusFallback:l,containers:m,features:p=15,...h}=t;Rt()||(p=0);let f=Pt(r);Er(p,{ownerDocument:f});let w=yr(p,{ownerDocument:f,container:r,initialFocus:i,initialFocusFallback:l});jr(p,{ownerDocument:f,container:r,containers:m,previousActiveElement:w});let S=gn(),H=ee(c=>{if(!ke(r.current))return;let T=r.current;(A=>A())(()=>{We(S.current,{[Ee.Forwards]:()=>{ve(T,Q.First,{skipElements:[c.relatedTarget,l]})},[Ee.Backwards]:()=>{ve(T,Q.Last,{skipElements:[c.relatedTarget,l]})}})})}),N=Ge(!!(p&2),"focus-trap#tab-lock"),k=xn(),I=s.useRef(!1),v={ref:a,onKeyDown(c){c.key=="Tab"&&(I.current=!0,k.requestAnimationFrame(()=>{I.current=!1}))},onBlur(c){if(!(p&4))return;let T=Ot(m);ke(r.current)&&T.add(r.current);let A=c.relatedTarget;qe(A)&&A.dataset.headlessuiFocusGuard!=="true"&&(Zt(T,A)||(I.current?ve(r.current,We(S.current,{[Ee.Forwards]:()=>Q.Next,[Ee.Backwards]:()=>Q.Previous})|Q.WrapAround,{relativeTo:c.target}):qe(c.target)&&Y(c.target)))}},C=he();return b.createElement(b.Fragment,null,N&&b.createElement(ut,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:H,features:dt.Focusable}),C({ourProps:v,theirProps:h,defaultTag:hr,name:"FocusTrap"}),N&&b.createElement(ut,{as:"button",type:"button","data-headlessui-focus-guard":!0,onFocus:H,features:dt.Focusable}))}let xr=ce(gr),wr=Object.assign(xr,{features:re});function br(t=!0){let e=s.useRef(X.slice());return Ke(([r],[a])=>{a===!0&&r===!1&&Mt(()=>{e.current.splice(0)}),a===!1&&r===!0&&(e.current=X.slice())},[t,X,e]),ee(()=>{var r;return(r=e.current.find(a=>a!=null&&a.isConnected))!=null?r:null})}function Er(t,{ownerDocument:e}){let r=!!(t&8),a=br(r);Ke(()=>{r||(e==null?void 0:e.activeElement)===(e==null?void 0:e.body)&&Y(a())},[r]),wn(()=>{r&&Y(a())})}function yr(t,{ownerDocument:e,container:r,initialFocus:a,initialFocusFallback:i}){let l=s.useRef(null),m=Ge(!!(t&1),"focus-trap#initial-focus"),p=Tt();return Ke(()=>{if(t===0)return;if(!m){i!=null&&i.current&&Y(i.current);return}let h=r.current;h&&Mt(()=>{if(!p.current)return;let f=e==null?void 0:e.activeElement;if(a!=null&&a.current){if((a==null?void 0:a.current)===f){l.current=f;return}}else if(h.contains(f)){l.current=f;return}if(a!=null&&a.current)Y(a.current);else{if(t&16){if(ve(h,Q.First|Q.AutoFocus)!==mt.Error)return}else if(ve(h,Q.First)!==mt.Error)return;if(i!=null&&i.current&&(Y(i.current),(e==null?void 0:e.activeElement)===i.current))return;console.warn("There are no focusable elements inside the <FocusTrap />")}l.current=e==null?void 0:e.activeElement})},[i,m,t]),l}function jr(t,{ownerDocument:e,container:r,containers:a,previousActiveElement:i}){let l=Tt(),m=!!(t&4);Nt(e==null?void 0:e.defaultView,"focus",p=>{if(!m||!l.current)return;let h=Ot(a);ke(r.current)&&h.add(r.current);let f=i.current;if(!f)return;let w=p.target;ke(w)?Zt(h,w)?(i.current=w,Y(w)):(p.preventDefault(),p.stopPropagation(),Y(f)):Y(i.current)},!0)}function Zt(t,e){for(let r of t)if(r.contains(e))return!0;return!1}var kr=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(kr||{}),Cr=(t=>(t[t.SetTitleId=0]="SetTitleId",t))(Cr||{});let Fr={0(t,e){return t.titleId===e.id?t:{...t,titleId:e.id}}},Je=s.createContext(null);Je.displayName="DialogContext";function Ne(t){let e=s.useContext(Je);if(e===null){let r=new Error(`<${t} /> is missing a parent <Dialog /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,Ne),r}return e}function Nr(t,e){return We(e.type,Fr,t,e)}let bt=ce(function(t,e){let r=s.useId(),{id:a=`headlessui-dialog-${r}`,open:i,onClose:l,initialFocus:m,role:p="dialog",autoFocus:h=!0,__demoMode:f=!1,unmount:w=!1,...S}=t,H=s.useRef(!1);p=function(){return p==="dialog"||p==="alertdialog"?p:(H.current||(H.current=!0,console.warn(`Invalid role [${p}] passed to <Dialog />. Only \`dialog\` and and \`alertdialog\` are supported. Using \`dialog\` instead.`)),"dialog")}();let N=$t();i===void 0&&N!==null&&(i=(N&ye.Open)===ye.Open);let k=s.useRef(null),I=Fe(k,e),v=Pt(k),C=i?0:1,[c,T]=s.useReducer(Nr,{titleId:null,descriptionId:null,panelRef:s.createRef()}),A=ee(()=>l(!1)),ge=ee(y=>T({type:0,id:y})),U=Rt()?C===0:!1,[Ae,G]=En(),Re={get current(){var y;return(y=c.panelRef.current)!=null?y:k.current}},ue=yn(),{resolveContainers:de}=jn({mainTreeNode:ue,portals:Ae,defaultContainers:[Re]}),me=N!==null?(N&ye.Closing)===ye.Closing:!1;Ln(f||me?!1:U,{allowed:ee(()=>{var y,be;return[(be=(y=k.current)==null?void 0:y.closest("[data-headlessui-portal]"))!=null?be:null]}),disallowed:ee(()=>{var y;return[(y=ue==null?void 0:ue.closest("body > *:not(#headlessui-portal-root)"))!=null?y:null]})});let _=kn.get(null);At(()=>{if(U)return _.actions.push(a),()=>_.actions.pop(a)},[_,a,U]);let xe=Cn(_,s.useCallback(y=>_.selectors.isTop(y,a),[_,a]));Fn(xe,de,y=>{y.preventDefault(),A()}),pr(xe,v==null?void 0:v.defaultView,y=>{y.preventDefault(),y.stopPropagation(),document.activeElement&&"blur"in document.activeElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur(),A()}),Nn(f||me?!1:U,v,de),An(U,k,A);let[Pe,we]=Sn(),Te=s.useMemo(()=>[{dialogState:C,close:A,setTitleId:ge,unmount:w},c],[C,c,A,ge,w]),fe=s.useMemo(()=>({open:C===0}),[C]),Me={ref:I,id:a,role:p,tabIndex:-1,"aria-modal":f?void 0:C===0?!0:void 0,"aria-labelledby":c.titleId,"aria-describedby":Pe,unmount:w},$e=!vr(),te=re.None;U&&!f&&(te|=re.RestoreFocus,te|=re.TabLock,h&&(te|=re.AutoFocus),$e&&(te|=re.InitialFocus));let De=he();return b.createElement(Rn,null,b.createElement(pt,{force:!0},b.createElement(Pn,null,b.createElement(Je.Provider,{value:Te},b.createElement(Tn,{target:k},b.createElement(pt,{force:!1},b.createElement(we,{slot:fe},b.createElement(G,null,b.createElement(wr,{initialFocus:m,initialFocusFallback:k,containers:de,features:te},b.createElement(Mn,{value:A},De({ourProps:Me,theirProps:S,slot:fe,defaultTag:Ar,features:Rr,visible:C===0,name:"Dialog"})))))))))))}),Ar="div",Rr=vt.RenderStrategy|vt.Static;function Pr(t,e){let{transition:r=!1,open:a,...i}=t,l=$t(),m=t.hasOwnProperty("open")||l!==null,p=t.hasOwnProperty("onClose");if(!m&&!p)throw new Error("You have to provide an `open` and an `onClose` prop to the `Dialog` component.");if(!m)throw new Error("You provided an `onClose` prop to the `Dialog`, but forgot an `open` prop.");if(!p)throw new Error("You provided an `open` prop to the `Dialog`, but forgot an `onClose` prop.");if(!l&&typeof t.open!="boolean")throw new Error(`You provided an \`open\` prop to the \`Dialog\`, but the value is not a boolean. Received: ${t.open}`);if(typeof t.onClose!="function")throw new Error(`You provided an \`onClose\` prop to the \`Dialog\`, but the value is not a function. Received: ${t.onClose}`);return(a!==void 0||r)&&!i.static?b.createElement(ft,null,b.createElement(Ce,{show:a,transition:r,unmount:i.unmount},b.createElement(bt,{ref:e,...i}))):b.createElement(ft,null,b.createElement(bt,{ref:e,open:a,...i}))}let Tr="div";function Mr(t,e){let r=s.useId(),{id:a=`headlessui-dialog-panel-${r}`,transition:i=!1,...l}=t,[{dialogState:m,unmount:p},h]=Ne("Dialog.Panel"),f=Fe(e,h.panelRef),w=s.useMemo(()=>({open:m===0}),[m]),S=ee(v=>{v.stopPropagation()}),H={ref:f,id:a,onClick:S},N=i?Dt:s.Fragment,k=i?{unmount:p}:{},I=he();return b.createElement(N,{...k},I({ourProps:H,theirProps:l,slot:w,defaultTag:Tr,name:"Dialog.Panel"}))}let $r="div";function Dr(t,e){let{transition:r=!1,...a}=t,[{dialogState:i,unmount:l}]=Ne("Dialog.Backdrop"),m=s.useMemo(()=>({open:i===0}),[i]),p={ref:e,"aria-hidden":!0},h=r?Dt:s.Fragment,f=r?{unmount:l}:{},w=he();return b.createElement(h,{...f},w({ourProps:p,theirProps:a,slot:m,defaultTag:$r,name:"Dialog.Backdrop"}))}let Lr="h2";function Sr(t,e){let r=s.useId(),{id:a=`headlessui-dialog-title-${r}`,...i}=t,[{dialogState:l,setTitleId:m}]=Ne("Dialog.Title"),p=Fe(e);s.useEffect(()=>(m(a),()=>m(null)),[a,m]);let h=s.useMemo(()=>({open:l===0}),[l]),f={ref:p,id:a};return he()({ourProps:f,theirProps:i,slot:h,defaultTag:Lr,name:"Dialog.Title"})}let Or=ce(Pr),Zr=ce(Mr);ce(Dr);let Hr=ce(Sr),Ht=Object.assign(Or,{Panel:Zr,Title:Hr,Description:Dn});function le({headline:t,type:e,changes:r,className:a}){const[i,l]=s.useState(!1);return o.jsx(ht,{onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},className:"relative flex",children:()=>o.jsxs(o.Fragment,{children:[o.jsx("span",{className:B("transition-all flex min-w-[1rem] h-4 text-center mx-0.5 px-1 rounded-full text-[10px] font-black text-neutral-100 cursor-default border border-inherit",e===Z.Add&&"bg-success-500 border-success-500",e===Z.Remove&&"bg-danger-500 border-danger-500",e===Z.Direct&&"bg-secondary-500 border-secondary-500",e===Z.Indirect&&"bg-warning-500 border-warning-500",e===Z.Metadata&&"bg-neutral-400 border-neutral-400",e===Z.Default&&"bg-neutral-600 border-neutral-600",a),children:r.length}),o.jsx(Ce,{show:i,as:s.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",children:o.jsx(ht.Panel,{className:"absolute top-6 right-0 z-10 transform flex p-2 bg-theme-lighter shadow-xl focus:ring-2 ring-opacity-5 rounded-lg ",children:o.jsx(ct,{headline:t,type:e,className:"w-full h-full max-w-[50vw] max-h-[40vh] overflow-hidden overflow-y-auto hover:scrollbar scrollbar--vertical",children:o.jsx(ct.Default,{type:e,changes:r})})})})]})})}function Ir(){const t=j(i=>i.planOverview),[e,r]=s.useState(t);return s.useEffect(()=>{z(t.isEmpty)&&t.isFinished&&r(new fn(t))},[t]),(z(t.isLatest)||t.isFetching)&&e.hasUpdates?o.jsxs("span",{className:"flex group items-center bg-neutral-5 dark:bg-neutral-20 px-1 py-1 rounded-full",children:[(je(e.hasChanges)||je(e.hasBackfills))&&o.jsx(Et,{className:"mr-2",children:"Changes"}),oe(e.added)&&o.jsx(le,{headline:"Added",type:Z.Add,changes:e.added,className:"-mr-2 group-hover:mr-0 z-[5]"}),oe(e.direct)&&o.jsx(le,{headline:"Directly Modified",type:Z.Direct,changes:e.direct,className:"-mr-2 group-hover:mr-0 z-[4]"}),oe(e.indirect)&&o.jsx(le,{headline:"Indirectly Modified",type:Z.Indirect,changes:e.indirect,className:"-mr-2 group-hover:mr-0 z-[3]"}),oe(e.metadata)&&o.jsx(le,{headline:"Metadata",type:Z.Metadata,changes:e.metadata,className:"-mr-2 group-hover:mr-0 z-[2]"}),oe(e.removed)&&o.jsx(le,{headline:"Removed",type:Z.Remove,changes:e.removed,className:"-mr-2 group-hover:mr-0 z-[1]"}),oe(e.backfills)?o.jsx(le,{headline:"Backfills",type:Z.Default,changes:e.backfills,className:"ml-4 group-hover:ml-2 z-[6]"}):o.jsx("div",{className:"ml-2 group-hover:ml-2 z-[6]"})]}):o.jsx(Et,{className:"pr-2 pl-0.5 py-1 rounded-full bg-neutral-5 dark:bg-neutral-20 text-neutral-500 dark:text-neutral-300",children:"No Changes"})}function Et({className:t,children:e}){const r=E(h=>h.environment),a=E(h=>h.addRemoteEnvironments),i=j(h=>h.planAction),{refetch:l}=Ye(),{refetch:m}=Ue(r.name,{planOptions:{skip_tests:!0,include_unmodified:!0}});function p(h){const{environments:f,default_target_environment:w,pinned_environments:S}=h??{};kt(f)&&a(Object.values(f),w,S)}return o.jsxs("p",{className:B("flex items-center text-xs text-neutral-600 dark:text-neutral-300 font-bold text-center whitespace-nowrap",t),children:[o.jsx(Be,{className:"w-5 h-5 !p-0 !m-0 !ml-0.5 !mr-1 border-none !rounded-full bg-neutral-10 dark:bg-neutral-20",variant:ze.Info,size:jt.sm,disabled:i.isProcessing,onClick:h=>{h.stopPropagation(),l().then(({data:f})=>{m(),p(f)})},children:o.jsx(Hn,{className:"text-neutral-500 dark:text-neutral-300 w-4 h-4"})}),e]})}function It({children:t}){return o.jsxs(Xt,{className:"inline-block",children:[o.jsx(_e,{className:"w-3 h-3 border border-neutral-10 mr-2"}),o.jsx("span",{className:"inline-block text-xs whitespace-nowrap",children:t})]})}let Ie;function Br(){const t=E(c=>c.modules),e=E(c=>c.environment),r=E(c=>c.models),a=j(c=>c.planAction),i=j(c=>c.planApply),l=j(c=>c.planOverview),m=j(c=>c.planCancel),p=j(c=>c.setPlanApply),h=j(c=>c.setPlanOverview),f=j(c=>c.setPlanCancel),w=j(c=>c.setPlanAction),S=j(c=>c.resetPlanTrackers),H=j(c=>c.clearPlanApply),{isFetching:N}=en(e.name),{isFetching:k}=tn(),{isFetching:I}=Ye(),{refetch:v,isFetching:C}=Ue(e.name,{planOptions:{skip_tests:!0,include_unmodified:!0}});return s.useEffect(()=>{r.size>0&&z(a.isProcessing)&&z(a.isRunningTask)&&(S(),H(),v())},[r,e]),s.useEffect(()=>{C&&(l.isFetching=!0,h(l)),N&&(i.isFetching=!0,p(i)),k&&(m.isFetching=!0,f(m))},[C,N,k]),s.useEffect(()=>{clearTimeout(Ie);const c=Ve.getPlanAction({planOverview:l,planApply:i,planCancel:m});c===ie.Done&&a.isRunningTask||c===a.value||(Ie=setTimeout(()=>{w(new Ve({value:c})),Ie=void 0},nn([ie.Running,ie.RunningTask,ie.Cancelling,ie.Applying],c)?0:500))},[l,i,m]),o.jsx("div",{className:"min-h-8 max-h-8 flex w-full items-center justify-end text-neutral-500",children:I?o.jsx(It,{children:"Loading Environments..."}):o.jsxs(o.Fragment,{children:[z(t.hasOnlyPlans)&&z(t.hasOnlyPlansAndErrors)&&o.jsx(W,{title:a.isProcessing?a.displayStatus(l):"Plan",to:q.Plan,icon:a.isProcessing?o.jsx(_e,{variant:ze.Success,className:"w-3 py-1"}):o.jsx(St,{className:B("w-5",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100")}),iconActive:a.isProcessing?o.jsx(_e,{variant:ze.Success,className:"w-3 py-1"}):o.jsx(Lt,{className:B("w-5",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100")}),before:o.jsx("p",{className:B("block mx-1 text-xs font-bold whitespace-nowrap",l.isFailed?"text-danger-500 dark:text-danger-100":"text-success-100"),children:a.isProcessing?a.displayStatus(l):"Plan"}),className:B("px-2 rounded-full py-0.5 mr-1",l.isFailed?"bg-danger-10 dark:bg-danger-500":"bg-success-500"),classActive:B(l.isFailed?"bg-danger-10 dark:bg-danger-500":"bg-success-500")}),o.jsx("div",{className:"flex justify-center items-center min-w-[6rem] max-w-full",children:o.jsx(pn,{className:"border-none mx-2 w-full",size:jt.sm,showAddEnvironment:!0,disabled:C||a.isProcessing||e.isInitialProd})}),o.jsx(Ir,{})]})})}function zr(){const t=Ct();return o.jsxs("div",{className:"flex",children:[o.jsx("button",{onClick:()=>t(-1),className:"inline-block text-neutral-700 dark:text-neutral-300 text-xs hover:bg-neutral-5 dark:hover:bg-neutral-10 px-1 py-1 rounded-full",children:o.jsx(Bn,{className:"min-w-4 h-4"})}),o.jsx("button",{onClick:()=>t(1),className:"inline-block text-neutral-700 dark:text-neutral-300 text-xs hover:bg-neutral-5 dark:hover:bg-neutral-10 px-1 py-1 rounded-full",children:o.jsx($n,{className:"min-w-4 h-4"})})]})}function _r(){const t=E(r=>r.modules),{isFetching:e}=Ft();return o.jsxs("div",{className:B("relative min-w-[10rem] px-2 min-h-[2rem] max-h-[2rem] w-full flex items-center",t.showHistoryNavigation?"justify-between":"justify-end",e&&"overflow-hidden"),children:[t.showHistoryNavigation&&o.jsx(zr,{}),e&&o.jsx("div",{className:"absolute w-full h-full flex justify-center items-center z-10 bg-transparent-20 backdrop-blur-lg",children:o.jsx(It,{children:"Loading Models..."})}),t.hasPlans&&o.jsx(Br,{}),t.hasErrors&&o.jsx(mn,{})]})}function Vr({show:t,children:e,afterLeave:r,onClose:a=()=>{}}){return o.jsx(Ce,{appear:!0,show:t,as:s.Fragment,afterLeave:r,children:o.jsxs(Ht,{as:"div",className:"relative z-50",onClose:a,children:[o.jsx("div",{className:"fixed inset-0 bg-overlay opacity-90"}),o.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:o.jsx("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:o.jsx(Ce.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e})})})]})})}function L({show:t,children:e,onClose:r,afterLeave:a}){return o.jsx(Vr,{show:t,onClose:r,afterLeave:a,children:o.jsx(Ht.Panel,{className:"min-w-[20rem] max-w-[50rem] transform rounded-xl bg-theme text-left align-middle shadow-xl transition-all overflow-hidden",children:e})})}function qr({children:t}){return o.jsx("div",{className:"py-4 px-5 m-2",children:t})}function Wr({children:t}){return o.jsx("h2",{className:"font-bold text-xl mb-2",children:t})}function Yr({children:t}){return o.jsx("h4",{className:"font-bold",children:t})}function Ur({children:t}){return o.jsx("p",{className:"text-sm",children:t})}function Gr({children:t}){return o.jsx("div",{className:"flex justify-end items-center py-3 px-3",children:t})}function Kr({details:t}){return o.jsx("ul",{className:"my-2 p-4 bg-warning-10 rounded-md max-h-[20vh] overflow-y-auto hover:scrollbar scrollbar--vertical",children:t.map(e=>o.jsx("li",{className:"text-sm",children:e},e))})}L.Headline=Wr;L.Tagline=Yr;L.Description=Ur;L.Actions=Gr;L.Main=qr;L.Details=Kr;const Jr=2e4,Qr=3e3;class Xr{constructor(e,r){se(this,"channels",new Map);se(this,"eventSource");se(this,"timerId");se(this,"source");se(this,"delay",Jr);this.source=e,this.delay=r??this.delay,this.setEventSource()}listen(e){e.addEventListener("error",r=>{this.reconnect(Qr)}),e.addEventListener("ping",r=>{this.reconnect(this.delay)})}cleanup(){var e;this.channels.forEach((r,a)=>{var i;D(r)&&((i=this.eventSource)==null||i.removeEventListener(a,r))}),(e=this.eventSource)==null||e.close(),this.eventSource=void 0}resubscribe(){this.channels.forEach((e,r)=>{var a;D(e)&&((a=this.eventSource)==null||a.addEventListener(r,e))})}reconnect(e){clearTimeout(this.timerId),this.timerId=setTimeout(()=>{console.log(`Reconnecting Event Source ${this.source}`),this.cleanup(),this.setEventSource(),this.resubscribe()},e)}getEventSource(){return new EventSource(this.source,{withCredentials:!0})}setEventSource(){this.eventSource=this.getEventSource(),this.listen(this.eventSource)}addChannel(e,r){var i;const a=this.getChannelHandler(e,r);(i=this.eventSource)==null||i.addEventListener(e,a),this.channels.set(e,a)}removeChannel(e){var a;const r=this.getChannel(e);D(r)&&((a=this.eventSource)==null||a.removeEventListener(e,r),this.channels.delete(e))}hasChannel(e){return D(this.getChannel(e))}getChannel(e){return this.channels.get(e)}getChannelHandler(e,r){return a=>{if(this.reconnect(this.delay),!($(e)||$(r)||$(a.data)))try{r(JSON.parse(a.data))}catch(i){console.warn(i)}}}}let pe;function ea(){return $(pe)&&(pe=new Xr(rn("/api/events"))),(t,e)=>({subscribe(){D(t)&&D(e)&&z(pe.hasChannel(t))&&pe.addChannel(t,e)},unsubscribe(){pe.removeChannel(t)}})}function Ca({content:t}){const e=an(),r=Ct(),{removeError:a,addError:i}=yt(),l=E(n=>n.modules),m=E(n=>n.environment),p=E(n=>n.environments),h=E(n=>n.showConfirmation),f=E(n=>n.confirmations),w=E(n=>n.setShowConfirmation),S=E(n=>n.removeConfirmation),H=E(n=>n.setModels),N=E(n=>n.addRemoteEnvironments),k=E(n=>n.addLocalEnvironment),I=E(n=>n.setEnvironment);let v;z(l.hasOnlyDataCatalog)&&(v=ea());const C=j(n=>n.planApply),c=j(n=>n.planOverview),T=j(n=>n.planCancel),A=j(n=>n.setPlanApply),ge=j(n=>n.setPlanOverview),U=j(n=>n.setPlanCancel),Ae=j(n=>n.setPlanAction),G=J(n=>n.files),Re=J(n=>n.selectedFile),ue=J(n=>n.setProject),de=J(n=>n.setFiles),me=J(n=>n.refreshFiles),_=J(n=>n.findArtifactByPath),xe=J(n=>n.setTests),Pe=J(n=>n.setActiveRange),we=ne(n=>n.storedTabs),Te=ne(n=>n.storedTabId),fe=ne(n=>n.selectTab),Me=ne(n=>n.createTab),$e=ne(n=>n.addTabs),te=ne(n=>n.closeTab),De=ne(n=>n.inTabs),y=E(n=>n.setVersion),{refetch:be,cancel:Bt}=sn(),{refetch:Qe,cancel:zt}=Ft(),{refetch:_t,cancel:Vt}=on(),{refetch:Xe,cancel:qt}=Ye(),{refetch:et,cancel:Wt}=Ue(m.name,{planOptions:{skip_tests:!0,include_unmodified:!0}}),ae=s.useCallback(function(u){const x=Array.from(p).find(g=>g.name===u);$(x)?k(u):I(x)},[p]),tt=s.useCallback(function(u){c.update(u),u.environment!==m.name&&ae(u.environment),ge(c)},[ae,m]),nt=s.useCallback(function(u){var g,M;C.update(u,c),u.environment!==m.name&&ae(u.environment),A(C);const x=je((g=u.meta)==null?void 0:g.done)&&((M=u.meta)==null?void 0:M.status)!==Oe.init;T.isFinished||T.isRunning||z(x)||Xe().then(({data:F})=>{et(),ot(F)})},[T,c,ae,m]),rt=s.useCallback(function(u){var x,g;T.update(u),u.environment!==m.name&&ae(u.environment),U(T),!(ln((x=u.meta)==null?void 0:x.done)||((g=u.meta)==null?void 0:g.status)===Oe.init)&&et()},[ae,m]),at=s.useCallback(function({changes:u,directories:x}){var g,M;u.sort(F=>F.change===He.Deleted?-1:1),u.forEach(({change:F,path:K,file:R})=>{var P,V;if(F===He.Modified){const O=G.get(K);if($(O)||$(R))return;O.update(R)}if(F===He.Deleted){const O=_(K)??G.get(K);if($(O))return;O instanceof Ze&&((P=O.parent)==null||P.removeDirectory(O)),O instanceof gt&&((V=O.parent)==null||V.removeFile(O),De(O)&&te(O))}});for(const F in x){const K=x[F],R=_(F);$(R)||((g=K.directories)==null||g.forEach(P=>{const V=_(P.path);$(V)&&R.addDirectory(new Ze(P,R))}),(M=K.files)==null||M.forEach(P=>{const V=G.get(P.path);$(V)&&R.addFile(new gt(P,R))}),R.directories.sort((P,V)=>P.name>V.name?1:-1),R.files.sort((P,V)=>P.name>V.name?1:-1))}me(),Pe(),Qe().then(({data:F})=>Le(F))},[G]),st=s.useCallback(function(u){const x=G.get(u.path);D(x)&&(x.isFormatted=u.status===Oe.success,me())},[G]),Yt=s.useCallback(function(u){if(cn(we))return;const x=we.map(({id:M,content:F})=>{const K=u.find(P=>P.id===M)??On(M),R=Me(K);return R.file.content=F??R.file.content??"",R}),g=x.find(M=>M.file.id===Te);$e(x),D(g)&&$(Re)&&fe(g)},[fe]);s.useEffect(()=>{be().then(({data:g})=>{y(g==null?void 0:g.version),je(g==null?void 0:g.has_running_task)&&Ae(new Ve({value:ie.RunningTask}))}),Qe().then(({data:g})=>Le(g));const n=v==null?void 0:v("errors",Ut),u=v==null?void 0:v("tests",Gt),x=v==null?void 0:v("models",Le);return x==null||x.subscribe(),l.hasPlans&&(u==null||u.subscribe(),Xe().then(({data:g})=>ot(g))),l.hasErrors&&(n==null||n.subscribe()),l.hasFiles&&_t().then(({data:g})=>{if($(g))return;const M=new Ze(g),F=M.allFiles;Yt(F),de(F),ue(M)}),()=>{Bt(),zt(),x==null||x.unsubscribe(),l.hasPlans&&(qt(),Wt()),l.hasErrors&&(n==null||n.unsubscribe()),l.hasTests&&(u==null||u.unsubscribe()),l.hasFiles&&Vt()}},[l]),s.useEffect(()=>{const n=v==null?void 0:v("plan-apply",nt);return l.hasPlans&&(n==null||n.subscribe()),()=>{l.hasPlans&&(n==null||n.unsubscribe())}},[nt,l]),s.useEffect(()=>{const n=v==null?void 0:v("plan-overview",tt);return l.hasPlans&&(n==null||n.subscribe()),()=>{l.hasPlans&&(n==null||n.unsubscribe())}},[tt,l]),s.useEffect(()=>{const n=v==null?void 0:v("plan-cancel",rt);return l.hasPlans&&(n==null||n.subscribe()),()=>{l.hasPlans&&(n==null||n.unsubscribe())}},[rt,l]),s.useEffect(()=>{const n=v==null?void 0:v("file",at);return n==null||n.subscribe(),()=>{n==null||n.unsubscribe()}},[at]),s.useEffect(()=>{const n=v==null?void 0:v("format-file",st);return n==null||n.subscribe(),()=>{n==null||n.unsubscribe()}},[st]),s.useEffect(()=>{(z(l.isEmpty)&&e.pathname===q.Home||e.pathname==="")&&r(l.defaultNavigationRoute(),{replace:!0})},[e,l]),s.useEffect(()=>{w(f.length>0)},[f]);function Le(n){D(n)&&(a(lt.Models),H(n))}function Ut(n){i(lt.General,n)}function Gt(n){xe(n)}function ot(n){const{environments:u,default_target_environment:x,pinned_environments:g}=n??{};kt(u)&&N(Object.values(u),x,g)}function Se(n){var u;(u=n==null?void 0:n.cancel)==null||u.call(n),w(!1)}const d=f[0];return o.jsxs(un.Page,{layout:"horizontal",children:[l.showModuleNavigation&&o.jsxs(o.Fragment,{children:[o.jsx(mr,{className:"overflow-hidden py-1 px-2 flex flex-col items-center"}),o.jsx(it,{orientation:"vertical"})]}),o.jsxs("div",{className:"flex flex-col overflow-hidden w-full h-full",children:[l.showNavigation&&o.jsxs(o.Fragment,{children:[o.jsx(_r,{}),o.jsx(it,{})]}),t??o.jsx(dn,{}),o.jsxs(L,{show:h,onClose:()=>{Se(d)},afterLeave:()=>{S()},onKeyDown:n=>{n.key==="Escape"&&Se(d)},children:[o.jsxs(L.Main,{children:[D(d==null?void 0:d.headline)&&o.jsx(L.Headline,{children:d==null?void 0:d.headline}),D(d==null?void 0:d.tagline)&&o.jsx(L.Tagline,{children:d==null?void 0:d.tagline}),D(d==null?void 0:d.details)&&o.jsx(L.Details,{details:d==null?void 0:d.details}),D(d==null?void 0:d.description)&&o.jsx(L.Description,{children:d==null?void 0:d.description}),d==null?void 0:d.children]}),o.jsxs(L.Actions,{children:[o.jsx(Be,{className:"font-bold",size:"md",variant:"danger",onClick:n=>{var u;n.stopPropagation(),(u=d==null?void 0:d.action)==null||u.call(d),w(!1)},children:(d==null?void 0:d.yesText)??"Confirm"}),o.jsx(Be,{size:"md",variant:"alternative",onClick:n=>{n.stopPropagation(),Se(d)},children:(d==null?void 0:d.noText)??"Cancel"})]})]})]})]})}export{Ca as default};
